---
import { getCollection, type CollectionEntry } from "astro:content";
import CertificationCard from "../ui/CertificationCard.astro";

const items = (await getCollection("certifications"))
  .filter((c: CollectionEntry<'certifications'>) => !c.data.draft)
  .sort((a: CollectionEntry<'certifications'>, b: CollectionEntry<'certifications'>) => (b.data.order ?? 0) - (a.data.order ?? 0));
---

<section id="certifications" class="px-4 md:px-20 py-20 scroll-mt-24 md:scroll-mt-32">
  <div class="italic mb-6 self-start font-['Instrument_Serif']
           text-4xl md:text-5xl">
    Certifications
  </div>

  <h2 class="mt-3 font-['Instrument_Serif'] text-[clamp(1.75rem,3.2vw,2.5rem)] leading-tight">
    Proof of Skills & Professional Growth
  </h2>

  <ul class="mt-6 grid gap-3 md:gap-4 max-w-full grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
    {items.map((entry: CollectionEntry<'certifications'>) => (
      <CertificationCard item={entry} />
    ))}
  </ul>
</section>

<script>
  import { animate, inView, stagger } from "motion";
  inView("#certifications", (el) => {
    const pill = el.querySelector("div.inline-flex");
    const h2 = el.querySelector("h2");
    const cards = el.querySelectorAll("li");

    pill && animate(pill, { opacity:[0,1], y:[8,0] } as any, { duration:.6, easing:"ease-out" } as any);
    h2 && animate(h2, { opacity:[0,1], y:[10,0] } as any, { duration:.7, easing:"ease-out", delay:.1 } as any);

    if (cards.length) {
      setTimeout(() => {
        animate(cards, { opacity:[0,1], y:[12,0] } as any,
          { delay: stagger(.1), duration:.5, easing:"cubic-bezier(.22,1,.36,1)" } as any
        );
      }, 150);
    }
  });
</script>
